<?php
$host = "localhost";
$user = "root";
$password = "123456";
$database = "winaishabu";

// เชื่อมต่อฐานข้อมูล
$conn = new mysqli($host, $user, $password, $database);
if ($conn->connect_error) {
    die("❌ การเชื่อมต่อล้มเหลว: " . $conn->connect_error);
}
mysqli_set_charset($conn, "utf8");

// อัปเดตรูปภาพตามประเภท
$update_queries = [
    "vegatable/vegatable.jpg" => [
        'ผักบุ้ง', 'ต้นหอมญี่ปุ่น', 'ข้าวโพดอ่อน', 'กวางตุ้ง', 'ผักขึ้นฉ่าย', 
        'ฮ่องเต้น้อย', 'ฟักทองญี่ปุ่น', 'วากาเมะเขียว', 'ผัดกาดขาว', 'เห็ดฟาง', 
        'เห็ดหูหนู', 'เห็ดเข็มทอง', 'ข้าวโพด', 'เห็ดชิเมจิขาว'
    ],
    "processed/IMG_9996.JPG" => [
        'เส้นอุด้ง', 'ลูกชิ้นปิงปอง', 'ลูกชิ้นรักบี้', 'ฟองเต้าหู้ม้วนห่อสาหร่าย', 
        'คริสตัลไข่ปลา', 'ลูกชิ้นกุ้ง', 'บะหมี่หยกไต้หวัน'
    ],
    "other/IMG_0001.JPG" => [
        'ซาลาเปาหมูแดง', 'ซาลาเปาหมูสับ', 'ซาลาเปาไส้ครีม', 'ซาลาเปาไส้ถั่วดำ', 
        'ขนมจีบหมู', 'ฮะเก๋า', 'เผือกทอด', 'ปอเปี๊ยะทอด', 'ขนมจีบกุ้ง', 'ขนมจีบปู', 
        'เฟรนฟราย', 'เสี่ยวหลงเปาไส้หมู', 'น้ำแร่', 'น้ำเก๊กฮวย', 'น้ำอัดลม', 
        'ชาเขียวรสน้ำผึ้งมะนาว', 'น้ำชาเขียวรสแตงโม', 'น้ำส้ม', 'น้ำมะพร้าว', 
        'ชานมไข่มุก', 'ทับทิมกรอบมะพร้าวอ่อน', 'บัวลอย', 'บัวลอยน้ำขิง','บัวลอยไส้มันม่วง'
    ],
    "Fruits/IMG_9989.JPG" => [
        'แตงโม', 'แอปเปิ้ล', 'กล้วยน้ำว้า', 'กีวี่ เขียว', 'ทับทิม', 'สับปะรด', 
        'แคนตาลูป', 'แก้วมังกร', 'ส้ม'
    ],
    "meat/Mix.jpg" => [
        'หมูนุ่มโรยงา', 'สันคอหมูสไลซ์', 'สันคอคุโรบูตะสไลซ์', 'สามชั้นสไลซ์', 
        'หมูบะช่อทรงเครื่อง'
    ],
    "Soups/Soup.JPG" => [
        'น้ำซุปน้ำดำ', 'น้ำซุปหมาล่า', 'น้ำซุปน้ำใส'
    ],
    "Soups/S__7806992_upscayl_4x_realesrgan-x4plus.png" => [
        'น้ำจิ้มสุกกี้', 'น้ำจิ้มซีฟู๊ด', 'น้ำจิ้มงา', 'พริกยอดสนแดง', 
        'กระเทียม', 'มะนาว'
    ]
];

// อัปเดตข้อมูลทีละหมวด
$total_affected = 0;
foreach ($update_queries as $image => $items) {
    $item_list = "'" . implode("','", $items) . "'";
    $sql = "UPDATE inventory SET image_url = '$image' WHERE item_name IN ($item_list)";
    if ($conn->query($sql) === TRUE) {
        $total_affected += $conn->affected_rows;
    } else {
        echo "❌ เกิดข้อผิดพลาดในการอัปเดต: " . $conn->error . "<br>";
    }
}

// แสดงผลลัพธ์
if ($total_affected > 0) {
    echo "✅ อัปเดตรูปภาพสำเร็จ จำนวนแถวที่ได้รับผลกระทบ: $total_affected";
} else {
    echo "⚠️ ไม่พบข้อมูลที่ตรงกันในฐานข้อมูล! โปรดตรวจสอบชื่อ `item_name`";
}

$conn->close();
?>
